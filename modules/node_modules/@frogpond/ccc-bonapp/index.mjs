import {get} from '@frogpond/ccc-lib'

export async function cafe(cafeId) {
	let url = 'https://legacy.cafebonappetit.com/api/2/cafes'
	let resp = await get(url, {json: true, query: {cafe: cafeId}})
	let cafeInfo = Object.assign({}, resp.body)
	cafeInfo.cafe = cafeInfo.cafes[cafeId]
	delete cafeInfo.cafes
	return cafeInfo
}

export async function menu(cafeId) {
	let url = 'https://legacy.cafebonappetit.com/api/2/menus'
	let resp = await get(url, {json: true, query: {cafe: cafeId}})
	let days = resp.body.days.map(dayInfo => {
		let info = Object.assign({}, dayInfo)
		info.cafe = info.cafes[cafeId]
		delete info.cafes
		return info
	})
	return Object.assign({}, resp.body, {days})
}

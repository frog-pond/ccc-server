import {get} from '@frogpond/ccc-lib'

export async function cafe(cafeId) {
	let url = 'https://legacy.cafebonappetit.com/api/2/cafes'
	let resp = await get(url, {searchParams: {cafe: cafeId}}).json()
	let cafeInfo = Object.assign({}, resp)
	cafeInfo.cafe = cafeInfo.cafes[cafeId]
	delete cafeInfo.cafes
	return cafeInfo
}

export async function nutrition(itemId) {
	let url = 'https://legacy.cafebonappetit.com/api/2/items'
	let resp = await get(url, {searchParams: {item: itemId}}).json()
	let itemInfo = Object.assign({}, resp)
	return itemInfo
}

export async function menu(cafeId) {
	let url = 'https://legacy.cafebonappetit.com/api/2/menus'
	let resp = await get(url, {searchParams: {cafe: cafeId}}).json()
	let days = resp.days.map(dayInfo => {
		let info = Object.assign({}, dayInfo)
		info.cafe = info.cafes[cafeId]
		delete info.cafes
		return info
	})
	return Object.assign({}, resp.body, {days})
}
